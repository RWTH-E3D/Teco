<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>teaser.logic.buildingobjects.calculation.ibpsa API documentation</title>
<meta name="description" content="This module includes IBPSA calculation class." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>teaser.logic.buildingobjects.calculation.ibpsa</code></h1>
</header>
<section id="section-intro">
<p>This module includes IBPSA calculation class.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;This module includes IBPSA calculation class.&#34;&#34;&#34;

import os
import pandas as pd
import teaser.logic.utilities as utilities


class IBPSA(object):
    &#34;&#34;&#34;Class to calculate parameters for AixLib output.

    This class holds functions to sort and partly rewrite zone and building
    attributes specific for IBPSA simulation. This includes the export of
    boundary conditions.

    Parameters
    ----------
    parent: Building()
        The parent class of this object, the Building the attributes are
        calculated for. (default: None)

    Attributes
    ----------
    file_internal_gains : str
        Filename for internal gains file
    version : dict
        Dictionary with supported libraries and their version numbers
    consider_heat_capacity : bool
        decides whether air capacity is considered or not for all thermal
        zones in the building


    &#34;&#34;&#34;

    def __init__(self, parent):
        &#34;&#34;&#34;Construct IBPSA.&#34;&#34;&#34;
        self.parent = parent
        self.file_internal_gains = &#34;InternalGains_&#34; + self.parent.name + &#34;.mat&#34;
        self.version = {
            &#34;AixLib&#34;: &#34;1.0.0&#34;,
            &#34;Buildings&#34;: &#34;7.0.0&#34;,
            &#34;BuildingSystems&#34;: &#34;2.0.0-beta2&#34;,
            &#34;IDEAS&#34;: &#34;2.1.0&#34;,
        }
        self.consider_heat_capacity = True

    def modelica_gains_boundary(self, zone, path=None):
        &#34;&#34;&#34;creates .mat file for internal gains boundary conditions

        This function creates a matfile (-v4) for building internal gains
        boundary conditions. It collects internal gain profiles of a specific
        zones and stores them into one file. It also calculates the internal
        gains from relative presence and values for heat output into W for
        direct usage in Annex models.

        Only person (convective and radiative) and machines (convective) are
        used in the simple Annex 60 examples.

        1. Column : time step
        2 Column : profile_persons, radiative
        3 Column : profile_persons, convective
        4 Column : profile_machines, convective

        Note
        ----------
        When time line is created, we need to add a 0 to first element of
        all boundaries. This is due to to expected format in Modelica.

        Parameters
        ----------
        zone : ThermalZone()
            TEASER instance of ThermalZone. As IBPSA computes single models
            for single zones, we need to generate individual files for zones
            and internal gains
        path : str
            optional path, when matfile is exported separately

        &#34;&#34;&#34;
        if path is None:
            path = utilities.get_default_path()
        else:
            pass

        utilities.create_path(path)
        path = os.path.join(path, self.file_internal_gains)

        export = pd.DataFrame(
            index=pd.date_range(&#34;2019-01-01 00:00:00&#34;, periods=8760, freq=&#34;H&#34;)
            .to_series()
            .dt.strftime(&#34;%m-%d %H:%M:%S&#34;)
        )

        export[&#34;person_rad_{}&#34;.format(zone.name)] = (
            zone.use_conditions.schedules[&#34;persons_profile&#34;]
            * (1 - zone.use_conditions.ratio_conv_rad_persons)
            * zone.use_conditions.fixed_heat_flow_rate_persons
            * zone.use_conditions.persons
            * zone.area
        )
        export[&#34;person_conv_{}&#34;.format(zone.name)] = (
            zone.use_conditions.schedules[&#34;persons_profile&#34;]
            * zone.use_conditions.ratio_conv_rad_persons
            * zone.use_conditions.fixed_heat_flow_rate_persons
            * zone.use_conditions.persons
            * zone.area
        )
        export[&#34;machines_conv_{}&#34;.format(zone.name)] = (
            zone.use_conditions.schedules[&#34;machines_profile&#34;]
            * zone.use_conditions.ratio_conv_rad_machines
            * zone.use_conditions.machines
            * zone.area
        )

        export.index = [(i + 1) * 3600 for i in range(8760)]
        self._delete_file(path=path)
        with open(path, &#34;a&#34;) as f:
            f.write(&#34;#1\n&#34;)
            # The size of the dataset is always 4 columns as each thermal zone has its own data file.
            f.write(&#34;double Internals(8761, 4)\n&#34;)
            # write the first row with t=0
            f.write(&#34;0\t{}&#34;.format(export.iloc[:1, :].to_csv(sep=&#34;\t&#34;, header=False, index=False)))
            export.to_csv(f, sep=&#34;\t&#34;, header=False, index_label=False)

    def _delete_file(self, path):
        &#34;&#34;&#34;Delete a file before new information is written to it.

        If a building with the exact name and project name is generated, we need to make
        sure to delete the old information in the text files. This helper function is a
        wrapper to delete a file with given filepath.

        Parameters:
        -----------
        path : str
            Absolute path to the file to be deleted.

        &#34;&#34;&#34;
        try:
            os.remove(path)
        except OSError:
            pass</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="teaser.logic.buildingobjects.calculation.ibpsa.IBPSA"><code class="flex name class">
<span>class <span class="ident">IBPSA</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<div class="desc"><p>Class to calculate parameters for AixLib output.</p>
<p>This class holds functions to sort and partly rewrite zone and building
attributes specific for IBPSA simulation. This includes the export of
boundary conditions.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>Building()</code></dt>
<dd>The parent class of this object, the Building the attributes are
calculated for. (default: None)</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>file_internal_gains</code></strong> :&ensp;<code>str</code></dt>
<dd>Filename for internal gains file</dd>
<dt><strong><code>version</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary with supported libraries and their version numbers</dd>
<dt><strong><code>consider_heat_capacity</code></strong> :&ensp;<code>bool</code></dt>
<dd>decides whether air capacity is considered or not for all thermal
zones in the building</dd>
</dl>
<p>Construct IBPSA.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class IBPSA(object):
    &#34;&#34;&#34;Class to calculate parameters for AixLib output.

    This class holds functions to sort and partly rewrite zone and building
    attributes specific for IBPSA simulation. This includes the export of
    boundary conditions.

    Parameters
    ----------
    parent: Building()
        The parent class of this object, the Building the attributes are
        calculated for. (default: None)

    Attributes
    ----------
    file_internal_gains : str
        Filename for internal gains file
    version : dict
        Dictionary with supported libraries and their version numbers
    consider_heat_capacity : bool
        decides whether air capacity is considered or not for all thermal
        zones in the building


    &#34;&#34;&#34;

    def __init__(self, parent):
        &#34;&#34;&#34;Construct IBPSA.&#34;&#34;&#34;
        self.parent = parent
        self.file_internal_gains = &#34;InternalGains_&#34; + self.parent.name + &#34;.mat&#34;
        self.version = {
            &#34;AixLib&#34;: &#34;1.0.0&#34;,
            &#34;Buildings&#34;: &#34;7.0.0&#34;,
            &#34;BuildingSystems&#34;: &#34;2.0.0-beta2&#34;,
            &#34;IDEAS&#34;: &#34;2.1.0&#34;,
        }
        self.consider_heat_capacity = True

    def modelica_gains_boundary(self, zone, path=None):
        &#34;&#34;&#34;creates .mat file for internal gains boundary conditions

        This function creates a matfile (-v4) for building internal gains
        boundary conditions. It collects internal gain profiles of a specific
        zones and stores them into one file. It also calculates the internal
        gains from relative presence and values for heat output into W for
        direct usage in Annex models.

        Only person (convective and radiative) and machines (convective) are
        used in the simple Annex 60 examples.

        1. Column : time step
        2 Column : profile_persons, radiative
        3 Column : profile_persons, convective
        4 Column : profile_machines, convective

        Note
        ----------
        When time line is created, we need to add a 0 to first element of
        all boundaries. This is due to to expected format in Modelica.

        Parameters
        ----------
        zone : ThermalZone()
            TEASER instance of ThermalZone. As IBPSA computes single models
            for single zones, we need to generate individual files for zones
            and internal gains
        path : str
            optional path, when matfile is exported separately

        &#34;&#34;&#34;
        if path is None:
            path = utilities.get_default_path()
        else:
            pass

        utilities.create_path(path)
        path = os.path.join(path, self.file_internal_gains)

        export = pd.DataFrame(
            index=pd.date_range(&#34;2019-01-01 00:00:00&#34;, periods=8760, freq=&#34;H&#34;)
            .to_series()
            .dt.strftime(&#34;%m-%d %H:%M:%S&#34;)
        )

        export[&#34;person_rad_{}&#34;.format(zone.name)] = (
            zone.use_conditions.schedules[&#34;persons_profile&#34;]
            * (1 - zone.use_conditions.ratio_conv_rad_persons)
            * zone.use_conditions.fixed_heat_flow_rate_persons
            * zone.use_conditions.persons
            * zone.area
        )
        export[&#34;person_conv_{}&#34;.format(zone.name)] = (
            zone.use_conditions.schedules[&#34;persons_profile&#34;]
            * zone.use_conditions.ratio_conv_rad_persons
            * zone.use_conditions.fixed_heat_flow_rate_persons
            * zone.use_conditions.persons
            * zone.area
        )
        export[&#34;machines_conv_{}&#34;.format(zone.name)] = (
            zone.use_conditions.schedules[&#34;machines_profile&#34;]
            * zone.use_conditions.ratio_conv_rad_machines
            * zone.use_conditions.machines
            * zone.area
        )

        export.index = [(i + 1) * 3600 for i in range(8760)]
        self._delete_file(path=path)
        with open(path, &#34;a&#34;) as f:
            f.write(&#34;#1\n&#34;)
            # The size of the dataset is always 4 columns as each thermal zone has its own data file.
            f.write(&#34;double Internals(8761, 4)\n&#34;)
            # write the first row with t=0
            f.write(&#34;0\t{}&#34;.format(export.iloc[:1, :].to_csv(sep=&#34;\t&#34;, header=False, index=False)))
            export.to_csv(f, sep=&#34;\t&#34;, header=False, index_label=False)

    def _delete_file(self, path):
        &#34;&#34;&#34;Delete a file before new information is written to it.

        If a building with the exact name and project name is generated, we need to make
        sure to delete the old information in the text files. This helper function is a
        wrapper to delete a file with given filepath.

        Parameters:
        -----------
        path : str
            Absolute path to the file to be deleted.

        &#34;&#34;&#34;
        try:
            os.remove(path)
        except OSError:
            pass</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="teaser.logic.buildingobjects.calculation.ibpsa.IBPSA.modelica_gains_boundary"><code class="name flex">
<span>def <span class="ident">modelica_gains_boundary</span></span>(<span>self, zone, path=None)</span>
</code></dt>
<dd>
<div class="desc"><p>creates .mat file for internal gains boundary conditions</p>
<p>This function creates a matfile (-v4) for building internal gains
boundary conditions. It collects internal gain profiles of a specific
zones and stores them into one file. It also calculates the internal
gains from relative presence and values for heat output into W for
direct usage in Annex models.</p>
<p>Only person (convective and radiative) and machines (convective) are
used in the simple Annex 60 examples.</p>
<ol>
<li>Column : time step
2 Column : profile_persons, radiative
3 Column : profile_persons, convective
4 Column : profile_machines, convective</li>
</ol>
<h2 id="note">Note</h2>
<p>When time line is created, we need to add a 0 to first element of
all boundaries. This is due to to expected format in Modelica.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>zone</code></strong> :&ensp;<code>ThermalZone()</code></dt>
<dd>TEASER instance of ThermalZone. As IBPSA computes single models
for single zones, we need to generate individual files for zones
and internal gains</dd>
<dt><strong><code>path</code></strong> :&ensp;<code>str</code></dt>
<dd>optional path, when matfile is exported separately</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def modelica_gains_boundary(self, zone, path=None):
    &#34;&#34;&#34;creates .mat file for internal gains boundary conditions

    This function creates a matfile (-v4) for building internal gains
    boundary conditions. It collects internal gain profiles of a specific
    zones and stores them into one file. It also calculates the internal
    gains from relative presence and values for heat output into W for
    direct usage in Annex models.

    Only person (convective and radiative) and machines (convective) are
    used in the simple Annex 60 examples.

    1. Column : time step
    2 Column : profile_persons, radiative
    3 Column : profile_persons, convective
    4 Column : profile_machines, convective

    Note
    ----------
    When time line is created, we need to add a 0 to first element of
    all boundaries. This is due to to expected format in Modelica.

    Parameters
    ----------
    zone : ThermalZone()
        TEASER instance of ThermalZone. As IBPSA computes single models
        for single zones, we need to generate individual files for zones
        and internal gains
    path : str
        optional path, when matfile is exported separately

    &#34;&#34;&#34;
    if path is None:
        path = utilities.get_default_path()
    else:
        pass

    utilities.create_path(path)
    path = os.path.join(path, self.file_internal_gains)

    export = pd.DataFrame(
        index=pd.date_range(&#34;2019-01-01 00:00:00&#34;, periods=8760, freq=&#34;H&#34;)
        .to_series()
        .dt.strftime(&#34;%m-%d %H:%M:%S&#34;)
    )

    export[&#34;person_rad_{}&#34;.format(zone.name)] = (
        zone.use_conditions.schedules[&#34;persons_profile&#34;]
        * (1 - zone.use_conditions.ratio_conv_rad_persons)
        * zone.use_conditions.fixed_heat_flow_rate_persons
        * zone.use_conditions.persons
        * zone.area
    )
    export[&#34;person_conv_{}&#34;.format(zone.name)] = (
        zone.use_conditions.schedules[&#34;persons_profile&#34;]
        * zone.use_conditions.ratio_conv_rad_persons
        * zone.use_conditions.fixed_heat_flow_rate_persons
        * zone.use_conditions.persons
        * zone.area
    )
    export[&#34;machines_conv_{}&#34;.format(zone.name)] = (
        zone.use_conditions.schedules[&#34;machines_profile&#34;]
        * zone.use_conditions.ratio_conv_rad_machines
        * zone.use_conditions.machines
        * zone.area
    )

    export.index = [(i + 1) * 3600 for i in range(8760)]
    self._delete_file(path=path)
    with open(path, &#34;a&#34;) as f:
        f.write(&#34;#1\n&#34;)
        # The size of the dataset is always 4 columns as each thermal zone has its own data file.
        f.write(&#34;double Internals(8761, 4)\n&#34;)
        # write the first row with t=0
        f.write(&#34;0\t{}&#34;.format(export.iloc[:1, :].to_csv(sep=&#34;\t&#34;, header=False, index=False)))
        export.to_csv(f, sep=&#34;\t&#34;, header=False, index_label=False)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="teaser.logic.buildingobjects.calculation" href="index.html">teaser.logic.buildingobjects.calculation</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="teaser.logic.buildingobjects.calculation.ibpsa.IBPSA" href="#teaser.logic.buildingobjects.calculation.ibpsa.IBPSA">IBPSA</a></code></h4>
<ul class="">
<li><code><a title="teaser.logic.buildingobjects.calculation.ibpsa.IBPSA.modelica_gains_boundary" href="#teaser.logic.buildingobjects.calculation.ibpsa.IBPSA.modelica_gains_boundary">modelica_gains_boundary</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>